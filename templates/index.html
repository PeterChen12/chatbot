<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat with Nutr</title>
    <style>
body {
    font-family: Arial, sans-serif;
    background-color: #f2f2f2;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
}

.chat-container {
    width: 400px;
    background-color: #fff;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    border-radius: 8px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.chat-header {
    background-color: #007bff;
    color: #fff;
    padding: 15px;
    text-align: center;
}

.chat-box {
    flex: 1;
    overflow-y: auto;
    padding: 15px;
    border-top: 1px solid #ddd;
    border-bottom: 1px solid #ddd;
}

.chat-input {
    display: flex;
    padding: 15px;
    border-top: 1px solid #ddd;
}

.chat-input input {
    flex: 1;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    margin-right: 10px;
}

.chat-input button {
    padding: 10px 15px;
    background-color: #007bff;
    color: #fff;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.chat-input button:hover {
    background-color: #0056b3;
}

.message {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
}

.message.user {
    justify-content: flex-end;
}

.message.assistant {
    justify-content: flex-start;
}

.message-content {
    max-width: 70%;
    padding: 10px 15px;
    border-radius: 20px;
    box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
}

.message.user .message-content {
    background-color: #007bff;
    color: #fff;
    border-bottom-right-radius: 0;
}

.message.assistant .message-content {
    background-color: #f1f1f1;
    color: #333;
    border-bottom-left-radius: 0;
}

.avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    margin: 0 10px;
}

.message.user .avatar {
    order: 2;
    margin-left: 10px;
}

.message.assistant .avatar {
    order: 1;
    margin-right: 10px;
}

.message.assistant .message-content {
    order: 2;
}
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <h1>Company Name</h1>
        </div>
        <div class="chat-box" id="chat-box"></div>
        <div class="chat-input">
            <input type="text" id="user-input" placeholder="Type your message here...">
            <button onclick="sendMessage()">Send</button>
        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const sendButton = document.querySelector(".chat-input button");
            const chatBox = document.getElementById("chat-box");
            const userInput = document.getElementById("user-input");

            // 初始化调用加载历史消息
            loadChatHistory();

            // 从localStorage的"chatHistory"加载信息
            function loadChatHistory() {
                const chatHistory = JSON.parse(localStorage.getItem("chatHistory")) || [];
                chatBox.innerHTML = ""; // Clear existing messages
                chatHistory.forEach(message => {
                    addMessage(message.role, message.content, false);
                });
            }

            // 将信息保存在"localStorage"的chatHistory中
            function saveChatHistory(role, content) {
                const chatHistory = JSON.parse(localStorage.getItem("chatHistory")) || [];
                chatHistory.push({ role, content });
                localStorage.setItem("chatHistory", JSON.stringify(chatHistory));
            }

            function addMessage(role, content, saveToHistory = true) {
                const message = document.createElement("div");
                message.className = `message ${role}`;
                
                const avatar = document.createElement("img");
                avatar.className = "avatar";
                avatar.src = role === "user" ? "data:image/png;base64,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" : "data:image/png;base64,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"; // 使用合适的头像图片路径

                const messageContent = document.createElement("div");
                messageContent.className = "message-content";
                messageContent.textContent = content;

                if (role === "user") {
                    message.appendChild(messageContent);
                    message.appendChild(avatar);
                } else {
                    message.appendChild(avatar);
                    message.appendChild(messageContent);
                }

                chatBox.appendChild(message);
                chatBox.scrollTop = chatBox.scrollHeight;
                
                // 保存新消息到Chathistory
                if (saveToHistory) {
                    saveChatHistory(role, content);
                }
            }

            function sendMessage() {
                const message = userInput.value.trim();
                if (message) {
                    addMessage("user", message);
                    userInput.value = "";
                    //后端API地址
                    fetch("/chat/123", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({ message })
                    })
                    .then(response => response.json())
                    .then(data => {
                        addMessage("assistant", data.message);
                    })
                    .catch(error => {
                        console.error("Error:", error);
                        addMessage("assistant", "Sorry, there was an error processing your request.");
                    });
                }
            }

            userInput.addEventListener("keydown", function(event) {
                if (event.key === "Enter") {
                    sendMessage();
                }
            });
            sendButton.addEventListener("click", sendMessage);
        });
    </script>
</body>
</html>
